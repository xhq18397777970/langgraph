<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>现代贪吃蛇 Snake Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4ADE80', // 蛇的颜色-绿色
                        secondary: '#EF4444', // 食物颜色-红色
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        game: ['"Press Start 2P"', 'cursive', 'sans-serif'],
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .game-shadow {
                box-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
            }
            .text-retro {
                font-family: 'Press Start 2P', cursive;
            }
        }
    </style>
</head>
<body class="bg-dark min-h-screen flex flex-col items-center justify-center text-light">
    <div class="container mx-auto p-4 max-w-2xl">
        <!-- 游戏标题 -->
        <h1 class="text-4xl font-game text-primary text-center mb-8 animate-pulse">
            <i class="fa fa-gamepad mr-2"></i>现代贪吃蛇
        </h1>
        <!-- 游戏信息 -->
        <div class="flex justify-between items-center mb-4 bg-gray-800 p-4 rounded-lg">
            <div class="flex items-center">
                <i class="fa fa-trophy text-yellow-400 mr-2"></i>
                <span class="text-xl">得分: <span id="score">0</span></span>
            </div>
            <div class="flex items-center">
                <i class="fa fa-tachometer text-blue-400 mr-2"></i>
                <span>速度: <span id="speed">中等</span></span>
            </div>
            <div class="flex items-center">
                <i class="fa fa-heart text-red-500 mr-2"></i>
                <span>最高分: <span id="highScore">0</span></span>
            </div>
        </div>
        <!-- 游戏画布 -->
        <div class="relative bg-gray-900 rounded-lg p-2 game-shadow">
            <canvas id="gameCanvas" width="600" height="600" class="rounded"></canvas>
            <!-- 游戏结束界面 -->
            <div id="gameOver" class="absolute inset-0 bg-gray-900 bg-opacity-90 flex flex-col items-center justify-center rounded hidden">
                <h2 class="text-3xl text-red-500 mb-4 text-game">游戏结束!</h2>
                <p class="text-xl mb-6">最终得分: <span id="finalScore">0</span></p>
                <button id="restartBtn" class="bg-primary hover:bg-green-600 text-dark font-bold py-2 px-6 rounded-lg transition transform hover:scale-105">
                    <i class="fa fa-redo mr-2"></i>重新开始
                </button>
            </div>
            <!-- 游戏开始界面 -->
            <div id="startScreen" class="absolute inset-0 bg-gray-900 bg-opacity-90 flex flex-col items-center justify-center rounded">
                <h2 class="text-3xl text-primary mb-6 text-game">贪吃蛇</h2>
                <p class="text-gray-300 mb-8 text-center">使用方向键控制蛇的移动</p>
                <div class="mb-6">
                    <label class="block mb-2 text-gray-300">选择难度:</label>
                    <div class="flex space-x-2">
                        <button class="difficulty-btn bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded" data-speed="150">
                            简单
                        </button>
                        <button class="difficulty-btn bg-yellow-600 hover:bg-yellow-700 text-white py-2 px-4 rounded" data-speed="100">
                            中等
                        </button>
                        <button class="difficulty-btn bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded" data-speed="50">
                            困难
                        </button>
                    </div>
                </div>
                <button id="startBtn" class="bg-primary hover:bg-green-600 text-dark font-bold py-3 px-8 rounded-lg text-lg transition transform hover:scale-105">
                    <i class="fa fa-play mr-2"></i>开始游戏
                </button>
            </div>
        </div>
        <!-- 游戏控制说明 -->
        <div class="mt-6 bg-gray-800 p-4 rounded-lg">
            <h3 class="text-xl mb-2 text-center"><i class="fa fa-info-circle mr-2"></i>游戏控制</h3>
            <div class="flex justify-center space-x-4 text-sm">
                <div><i class="fa fa-arrow-up mr-1"></i> 向上移动</div>
                <div><i class="fa fa-arrow-down mr-1"></i> 向下移动</div>
                <div><i class="fa fa-arrow-left mr-1"></i> 向左移动</div>
                <div><i class="fa fa-arrow-right mr-1"></i> 向右移动</div>
                <div><i class="fa fa-pause mr-1"></i> 空格键暂停</div>
            </div>
        </div>
    </div>
    <script>
        // 游戏变量
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const speedElement = document.getElementById('speed');
        const highScoreElement = document.getElementById('highScore');
        const finalScoreElement = document.getElementById('finalScore');
        const gameOverElement = document.getElementById('gameOver');
        const startScreenElement = document.getElementById('startScreen');
        const startBtn = document.getElementById('startBtn');
        const restartBtn = document.getElementById('restartBtn');
        // 游戏参数
        const gridSize = 20;
        const tileCount = canvas.width / gridSize;
        let snake = [];
        let direction = { x: 1, y: 0 };
        let food = {};
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let gameSpeed = 100;
        let gameInterval;
        let isPaused = false;
        let gameStarted = false;
        // 初始化最高分显示
        highScoreElement.textContent = highScore;
        // 初始化蛇
        function initSnake() {
            snake = [
                { x: 10, y: 10 }
            ];
            direction = { x: 1, y: 0 };
        }
        // 生成食物
        function generateFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
            // 确保食物不会生成在蛇身上
            for (let segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    generateFood();
                    break;
                }
            }
        }
        // 绘制游戏
        function draw() {
            // 清空画布
            ctx.fillStyle = '#111827';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            // 绘制网格
            ctx.strokeStyle = '#1f2937';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= tileCount; i++) {
                // 垂直线
                ctx.beginPath();
                ctx.moveTo(i * gridSize, 0);
                ctx.lineTo(i * gridSize, canvas.height);
                ctx.stroke();
                // 水平线
                ctx.beginPath();
                ctx.moveTo(0, i * gridSize);
                ctx.lineTo(canvas.width, i * gridSize);
                ctx.stroke();
            }
            // 绘制蛇
            snake.forEach((segment, index) => {
                if (index === 0) {
                    // 蛇头
                    ctx.fillStyle = '#10b981';
                    ctx.shadowColor = '#10b981';
                    ctx.shadowBlur = 10;
                } else {
                    // 蛇身
                    ctx.fillStyle = '#4ade80';
                    ctx.shadowColor = '#4ade80';
                    ctx.shadowBlur = 5;
                }
                ctx.fillRect(segment.x * gridSize + 2, segment.y * gridSize + 2, gridSize - 4, gridSize - 4);
                ctx.shadowBlur = 0;
            });
            // 绘制食物
            ctx.fillStyle = '#ef4444';
            ctx.shadowColor = '#ef4444';
            ctx.shadowBlur = 10;
            // 绘制圆形食物
            ctx.beginPath();
            ctx.arc(
                food.x * gridSize + gridSize / 2,
                food.y * gridSize + gridSize / 2,
                gridSize / 2 - 2,
                0,
                2 * Math.PI
            );
            ctx.fill();
            ctx.shadowBlur = 0;
        }
        // 更新游戏状态
        function update() {
            if (isPaused || !gameStarted) return;
            // 移动蛇头
            const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };
            // 检查墙壁碰撞
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                endGame();
                return;
            }
            // 检查自身碰撞
            for (let segment of snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    endGame();
                    return;
                }
            }
            // 添加新头部
            snake.unshift(head);
            // 检查是否吃到食物
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                scoreElement.textContent = score;
                generateFood();
            } else {
                // 如果没有吃到食物，移除尾部
                snake.pop();
            }
        }
        // 游戏主循环
        function gameLoop() {
            update();
            draw();
        }
        // 开始游戏
        function startGame() {
            if (gameStarted) return;
            initSnake();
            generateFood();
            score = 0;
            scoreElement.textContent = score;
            gameStarted = true;
            isPaused = false;
            startScreenElement.classList.add('hidden');
            gameOverElement.classList.add('hidden');
            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(gameLoop, gameSpeed);
        }
        // 结束游戏
        function endGame() {
            gameStarted = false;
            clearInterval(gameInterval);
            // 更新最高分
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHighScore', highScore);
                highScoreElement.textContent = highScore;
            }
            finalScoreElement.textContent = score;
            gameOverElement.classList.remove('hidden');
        }
        // 重新开始游戏
        function restartGame() {
            gameOverElement.classList.add('hidden');
            startGame();
        }
        // 暂停/继续游戏
        function togglePause() {
            if (!gameStarted) return;
            isPaused = !isPaused;
            if (isPaused) {
                clearInterval(gameInterval);
            } else {
                gameInterval = setInterval(gameLoop, gameSpeed);
            }
        }
        // 键盘控制
        document.addEventListener('keydown', (e) => {
            if (!gameStarted || isPaused) {
                if (e.code === 'Space') {
                    e.preventDefault();
                    if (!gameStarted) {
                        startGame();
                    } else {
                        togglePause();
                    }
                }
                return;
            }
            switch (e.code) {
                case 'ArrowUp':
                    if (direction.y === 0) {
                        direction = { x: 0, y: -1 };
                    }
                    break;
                case 'ArrowDown':
                    if (direction.y === 0) {
                        direction = { x: 0, y: 1 };
                    }
                    break;
                case 'ArrowLeft':
                    if (direction.x === 0) {
                        direction = { x: -1, y: 0 };
                    }
                    break;
                case 'ArrowRight':
                    if (direction.x === 0) {
                        direction = { x: 1, y: 0 };
                    }
                    break;
                case 'Space':
                    e.preventDefault();
                    togglePause();
                    break;
            }
        });
        // 难度选择
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                gameSpeed = parseInt(btn.dataset.speed);
                // 更新速度显示
                if (gameSpeed >= 150) {
                    speedElement.textContent = '简单';
                } else if (gameSpeed >= 100) {
                    speedElement.textContent = '中等';
                } else {
                    speedElement.textContent = '困难';
                }
                // 更新按钮样式
                document.querySelectorAll('.difficulty-btn').forEach(b => {
                    b.classList.remove('ring-2', 'ring-white');
                });
                btn.classList.add('ring-2', 'ring-white');
            });
        });
        // 事件监听
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', restartGame);
        // 初始化游戏
        draw();
    </script>
</body>
</html>